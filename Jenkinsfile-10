pipeline {
    agent any
    
    environment {
        K8S_CONFIG = '/home/jenkins/.kube/config'  // Path to kubeconfig
    }

    stages {
        stage('Deploy to Kubernetes') {
            steps {
                script {
                    withCredentials([file(credentialsId: 'my-kubeconfig-id', variable: 'KUBECONFIG_FILE')]) {
                        sh 'export KUBECONFIG=$KUBECONFIG_FILE'
                        // Deploy the pod to Kubernetes
                        sh 'kubectl run test-pod --image=nginx --restart=Never --namespace=default'
                    }
                }
            }
        }
    }
}
